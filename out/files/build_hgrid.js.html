<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>build/hgrid.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/HGrid.html">HGrid</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: build/hgrid.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Prototype for creating a Hierarchical Grid Structure
 *
 * @class HGrid
 * @author Jake Rosenberg
 * @author Alexander Ferguson
 * test
 */
var HGrid = {
    //Gives each div a class based on type (folder or file)
    /**
    Default options for HGrid

    @property defaultOptions
    @type {Object}
    @param defaultOptions.container null
    @param defaultOptions.url null
    @param defaultOptions.info null
    @param defaultOptions.columns Uid and Name columns
    @param defaultOptions.editable false
    @param defaultOptions.enableCellNavigation false
    @param defaultOptions.asyncEditorLoading false
    @param defaultOptions.enableColumnReorder true
    @param defaultOptions.sortAsc true
    @param defaultOptions.dragDrop true
    @param defaultOptions.dropZone true
    @param defaultOptions.dropZonePreviewsContainer null
    @param defaultOptions.navLevel null
    @param defaultOptions.breadcrumbBox null
    @param defaultOptions.largeGuide true
    @param defaultOptions.clickUploadElement true
    @param defaultOptions.topCrumb true
    @param defaultOptions.forceFitColumns true
    @param defaultOptions.autoHeight true
    @param defaultOptions.navigation true
    **/
    defaultOptions: {
        container: null,
        url: null,
        info: null,
        columns: [
            {id: &quot;uid&quot;, name: &quot;uid&quot;, width: 40, field: &quot;uid&quot;},
            {id: &quot;name&quot;, name: &quot;Name&quot;, field: &quot;name&quot;, width: 450, cssClass: &quot;cell-title&quot;, sortable: true, defaultSortAsc: true}
        ],
        editable: false,
        enableCellNavigation: false,
        asyncEditorLoading: false,
        enableColumnReorder: true,
        sortAsc: true,
        dragDrop: true,
        dropZone: true,
        dropZonePreviewsContainer: null,
        navLevel: &quot;null&quot;,
        breadcrumbBox: null,
        largeGuide: true,
        clickUploadElement: true,
        topCrumb: true,
        forceFitColumns: true,
        autoHeight: true,
        navigation: true
    },

    Slick: {
    },

    /**
    Data for the HGrid

    @property data
    @type Array
    @default null
    **/
    data: null,
    /**
    Currently rendered rows

    @property currentlyRendered
    @type Array
    @default []
    **/
    currentlyRendered: [],
    /**
    Current indent shift

    @property currentIndentShift
    @type int
    @default 0
    **/
    currentIndentShift: 0,
    /**
    Dropzone Object

    @property dropZoneObj
    @type {Object}
    @default null
    **/
    dropZoneObj: null,

    /**
     * This function creates a new HGrid object and calls initialize()
     * @constructor
     * @method create
     *
     * @param {Object} options Data to be passed to grid
     *   @param {String} options.url Url to post to
     *   @param {Object} options.info Information dictionary
     *     @param options.info.parent_uid Parent unique ID
     *     @param options.info.uid Unique ID
     *     @param options.info.name Name
     *     @param {String} options.info.type Folder or file
     *   @param {String} options.container Div ID of container for HGrid
     * @return {HGrid} Returns a new HGrid object.
     */
    create: function(options) {
        var _this = this;
        var self = Object.create(_this);
        self.options = $.extend({}, self.defaultOptions, options);
        var urls = [&#x27;urlAdd&#x27;,&#x27;urlMove&#x27;,&#x27;urlEdit&#x27;,&#x27;urlDelete&#x27;];
        for (var i = 0; i&lt;urls.length; i++) {
            if (!self.options[urls[i]]) {
                self.options[urls[i]] = self.options[&#x27;url&#x27;];
            }
            if (typeof self.options[urls[i]] === &quot;function&quot;) {
                self.options[urls[i]] = self.options[urls[i]]();
            }
        }
        self.initialize();
        $.extend(this, {

            hGridOnMouseEnter: new self.Slick.Event(),
            hGridOnMouseLeave: new self.Slick.Event(),
            hGridOnClick: new self.Slick.Event(),
            /**
             Fired before a move occurs

             @event hGridBeforeMove
             @param {Object} e Event object
             @param {Object} args
                @param args.rows Array of unique IDs of rows moving
                @param args.insertBefore Row ID of destination row to insert before
             **/
            hGridBeforeMove: new self.Slick.Event(),
            /**
             Fired after a move occurs

             @event hGridAfterMove
             @param {Object} e Event object
             @param {Object} args
                @param args.rows Array of unique IDs of rows moving
                @param args.insertBefore Row ID of destination row to insert before
             **/
            hGridAfterMove: new self.Slick.Event(),
            /**
             Fired before an edit occurs

             @event hGridBeforeEdit
             @param {Object} e Event object
             @param {Object} args
                @param args.item Item being changed
                @param args.name New name
             **/
            hGridBeforeEdit: new self.Slick.Event(),
            /**
             Fired after an edit occurs

             @event hGridAfterEdit
             @param {Object} e Event object
             @param {Object} args
                @param args.item Item being changed
                @param args.name New name
                @param args.success Boolean, whether or not the edit succeeded
             **/
            hGridAfterEdit: new self.Slick.Event(),
            /**
             Fired before a delete occurs

             @event hGridBeforeDelete
             @param {Object} e Event object
             @param {Object} args
                @param args.items Array of unique IDs to be deleted
             **/
            hGridBeforeDelete: new self.Slick.Event(),
            /**
             Fired after a delete occurs

             @event hGridAfterDelete
             @param {Object} e Event object
             @param {Object} args
                @param args.items Array of unique IDs to be deleted
                @param args.success Boolean, whether or not the delete succeeded
             **/
            hGridAfterDelete: new self.Slick.Event(),
            /**
             Fired before an add occurs

             @event hGridBeforeAdd
             @param {Object} e Event object
             @param {Object} args
                @param args.item Item to be added
                @param args.parent Parent item for new item
             **/
            hGridBeforeAdd: new self.Slick.Event(),
            /**
             Fired after an add occurs

             @event hGridAfterAdd
             @param {Object} e Event object
             @param {Object} args
                @param args.item Item to be added
                @param args.parent Parent item for new item
                @param args.success Boolean, whether or not the add succeeded
             **/
            hGridAfterAdd: new self.Slick.Event(),
            /**
             Fired before an upload occurs

             @event hGridBeforeUpload
             @param {Object} e Event object
             @param {Object} args
                @param args.item File object being added
                @param args.parent Parent item for new file
             **/
            hGridBeforeUpload: new self.Slick.Event(),
            /**
             Fired after an upload occurs

             @event hGridAfterUpload
             @param {Object} e Event object
             @param {Object} args
                @param args.item File object being added
                @param args.success Boolean, whether or not the upload succeeded
             **/
            hGridAfterUpload: new self.Slick.Event(),
            /**
             Fired on success response from server on upload

             @event hGridOnUpload
             @param {Object} e Event object
             @param {Object} args File object response
             **/
            hGridOnUpload: new self.Slick.Event(),
             /**
             Fired on success response from server on upload

             @event hGridAfterNav
             @param {Object} e Event object
             @param {Object} args nav level
             **/
            hGridAfterNav: new self.Slick.Event()
        });
        return self;
    },

    initialize: function() {
        var hGridContainer = this.options.container;
        var hGridInfo = this.options.info;
        var hGridColumns = this.options.columns;
        this.data = this.prep(hGridInfo);
        this.Slick = $.extend({}, Slick);
        this.Slick.dataView = new this.Slick.Data.DataView({ inlineFilters: true });
//        this.Slick.dataView = $.extend({}, Slick.Data.DataView({ inlineFilters: true }));
//        this.Slick.dataView = new Slick.Data.DataView({ inlineFilters: true });
        this.Slick.dataView.beginUpdate();
        this.Slick.dataView.setItems(this.data);
        var data = this.data;
        var dataView = this.Slick.dataView;
        this.Slick.dataView.setFilterArgs([data, this]);
        this.Slick.dataView.setFilter(this.myFilter);
        this.Slick.dataView.endUpdate();
        if(this.options.dragDrop){
            hGridColumns.unshift({id: &quot;#&quot;, name: &quot;&quot;, width: 40, behavior: &quot;selectAndMove&quot;, selectable: false, resizable: false, cssClass: &quot;cell-reorder dnd&quot;});
        }
        this.Slick.grid = new this.Slick.Grid(hGridContainer, this.Slick.dataView, hGridColumns, this.options);

        var _this = this;
        $.each(this.options.columns, function(idx, elm) {
            if (elm[&#x27;primary&#x27;]==true &amp;&amp; !elm.formatter){
                elm.formatter = _this.defaultTaskNameFormatter;
            }
        });
        if(this.options.columns===this.defaultOptions.columns) {
            this.options.columns[this.Slick.grid.getColumnIndex(&#x27;name&#x27;)].formatter = this.defaultTaskNameFormatter;
        }
        this.options.columns[this.Slick.grid.getColumnIndex(&#x27;name&#x27;)].validator = this.requiredFieldValidator;
        this.Slick.grid.invalidate();
        this.Slick.grid.render();
        if(this.options.topCrumb) {
            this.updateBreadcrumbsBox();
        }
        this.setupListeners();
        if(this.options.dropZone){
            this.dropZoneInit(this);
        }
        else{
            if(typeof Dropzone !== &#x27;undefined&#x27;){
                Dropzone.autoDiscover = false;
            }
        }
    },

    defaultTaskNameFormatter: function(row, cell, value, columnDef, dataContext) {
        value = value.replace(/&amp;/g,&quot;&amp;amp;&quot;).replace(/&lt;/g,&quot;&amp;lt;&quot;).replace(/&gt;/g,&quot;&amp;gt;&quot;);
        var spacer = &quot;&lt;span style=&#x27;display:inline-block;height:1px;width:&quot; + (15 * dataContext[&quot;indent&quot;]) + &quot;px&#x27;&gt;&lt;/span&gt;&quot;;
        if (dataContext[&#x27;type&#x27;]==&#x27;folder&#x27;) {
            if (dataContext._collapsed) {
                return spacer + &quot; &lt;span class=&#x27;toggle expand nav-filter-item&#x27; data-hgrid-nav=&quot; + dataContext[&#x27;uid&#x27;] + &quot;&gt;&lt;/span&gt;&lt;span class=&#x27;folder&#x27;&gt;&lt;/span&gt;&amp;nbsp;&quot; + value + &quot;&lt;/a&gt;&quot;;
            } else {
                return spacer + &quot; &lt;span class=&#x27;toggle collapse nav-filter-item&#x27; data-hgrid-nav=&quot; + dataContext[&#x27;uid&#x27;] + &quot;&gt;&lt;/span&gt;&lt;span class=&#x27;folder&#x27;&gt;&lt;/span&gt;&amp;nbsp;&quot; + value + &quot;&lt;/a&gt;&quot;;
            }
        } else {
            return spacer + &quot; &lt;span class=&#x27;toggle&#x27;&gt;&lt;/span&gt;&lt;span class=&#x27;file&#x27;&gt;&lt;/span&gt;&amp;nbsp;&quot; + value;
        }
    },

    requiredFieldValidator: function (value) {
        if (value == null || value == undefined || !value.length) {
            return {valid: false, msg: &quot;This is a required field&quot;};
        } else {
            return {valid: true, msg: null};
        }
    },

    myFilter: function (item, args) {
        var data = args[0];
        var _this = args[1];
        if (_this.options.navLevel != &quot;null&quot;) {
            if ( item[&quot;sortpath&quot;].indexOf(_this.options.navLevel) != 0 ) {
                return false;
            }
            if ( (item[&quot;sortpath&quot;] != _this.options.navLevel) &amp;&amp; (item.parent == null) ) {
                return false;
            }
            var navLevelChecker = _this.getItemByValue(data, _this.options.navLevel, &#x27;sortpath&#x27;)
            if ( (item[&#x27;uid&#x27;] != navLevelChecker[&#x27;uid&#x27;]) &amp;&amp; (item[&#x27;parent_uid&#x27;] == navLevelChecker[&#x27;parent_uid&#x27;])){
                return false;
            }
        }
        if (item.parent != null) {
            var parent = _this.getItemByValue(data, item.parent_uid, &#x27;uid&#x27;);
            while (parent) {
                if (parent._collapsed) {
                    return false;
                }
                parent = _this.getItemByValue(data, parent.parent_uid, &#x27;uid&#x27;);
            }

            item[&#x27;indent&#x27;] = item[&#x27;absoluteIndent&#x27;] - _this.currentIndentShift;
            _this.currentlyRendered.push(item);
            return true;
        } else {
            item[&#x27;indent&#x27;] = item[&#x27;absoluteIndent&#x27;] - _this.currentIndentShift;
            _this.currentlyRendered.push(item);
            return true;
        }
    },

    updateNav: function(){
        var _this = this;
        var nav = _this.options.navLevel;
        nav = nav.split(&quot;/&quot;);
        nav = nav.pop();
        this.navLevelFilter(nav);
    },

    navLevelFilter: function(itemUid) {
        var _this = this;
        var item = _this.getItemByValue(_this.data, itemUid, &quot;uid&quot;);
        var navReset = _this.options.navLevel;
        _this.currentlyRendered = [];
        if (item &amp;&amp; itemUid!==&quot;&quot;) {
            _this.currentIndentShift = item[&#x27;absoluteIndent&#x27;];
            try {
                if(!item[&quot;sortpath&quot;]) throw &quot;This item has no sort path&quot;;
                _this.options.navLevel = item[&quot;sortpath&quot;];
            } catch(e) {
                console.error(e);
                console.log(&quot;This is not a valid item&quot;);
                _this.options.navLevel = navReset;
            }
        } else {
            _this.options.navLevel = &quot;null&quot;;
            _this.currentIndentShift = 0;
            _this.Slick.grid.invalidate();
            _this.updateBreadcrumbsBox(itemUid);
            _this.Slick.dataView.setFilterArgs([_this.data, this])
            _this.Slick.dataView.setFilter(_this.myFilter);
            return;
        }

        _this.Slick.dataView.setFilterArgs([_this.data, this])
        _this.Slick.dataView.setFilter(_this.myFilter);
        _this.Slick.grid.invalidate();
        _this.updateBreadcrumbsBox(itemUid);
        _this.hGridAfterNav.notify(item);
    },

     /**
     * This function updates the breadcrumbs element on the page during navigation of directories
     * @method updateBreadcrumbsBox
     *
     * @param {String} itemUid uid of the new item to display as breadcrumbs parent
    */
    updateBreadcrumbsBox: function(itemUid) {
        var _this = this;
        var item = _this.getItemByValue(_this.data, itemUid, &quot;uid&quot;);
        var bcb = _this.options.breadcrumbBox;
        $(bcb).addClass(&quot;breadcrumb&quot;);
        var spacer = &quot; / &quot;;
        var crumbs = [];
        $(bcb).empty();
        var levels = [];
        if (item &amp;&amp; itemUid!==&quot;&quot; &amp;&amp; itemUid!==false) {
            try {
                levels = item[&quot;path&quot;].slice();
                if(!item[&quot;path&quot;]) throw &quot;This item has no path&quot;;
            } catch(e) {
                console.error(e);
                console.log(&quot;This is not a valid item&quot;);
                levels = [];
            }
        }
        if (_this.options.topCrumb){
            var topCrumb = &#x27;&lt;span class=&quot;hgrid-breadcrumb&quot;&gt;&lt;a href=&quot;#&quot; data-hgrid-nav=&quot;&quot;&gt;&#x27; + &quot;HGrid&quot; + &#x27;&lt;/a&gt;&lt;/span&gt;&#x27;;
            crumbs.push(topCrumb);
        }
        for (var i = 0; i&lt;levels.length; i++) {
            var crumb = &#x27;&lt;span class=&quot;hgrid-breadcrumb&quot;&gt;&lt;a href=&quot;#&quot; data-hgrid-nav=&quot;&#x27; + levels[i] + &#x27;&quot;&gt;&#x27; + _this.getItemByValue(_this.data, levels[i], &#x27;uid&#x27;)[&#x27;name&#x27;] + &#x27;&lt;/a&gt;&lt;/span&gt;&#x27;;
            crumbs.push(crumb);
        }
        for (var i = 0; i&lt;crumbs.length; i++) {
            $(bcb).append(crumbs[i]);
            $(bcb).append(spacer);
        }
    },


    dropZoneInit: function (hGrid){// Turn off the discover option so the URL error is not thrown with custom configuration
        var Dropzone = window.Dropzone;
        Dropzone.autoDiscover = false;
        var url;
        var bool = false;
// Instantiate this Dropzone
        if(typeof hGrid.options[&#x27;urlAdd&#x27;] === &quot;string&quot;){
            url = hGrid.options[&#x27;urlAdd&#x27;];
        }
        else {
            url = hGrid.options[&#x27;url&#x27;];
            bool = true;
        }
        var myDropzone = new Dropzone(hGrid.options.container, {
            url: url,
            clickable: hGrid.options.clickUploadElement,
            previewsContainer: hGrid.options.dropZonePreviewsContainer,
            addRemoveLinks: true,
            dropDestination: null
        } );

        hGrid.dropZoneObj = myDropzone;
// Get the SlickGrid Row under the dragged file
        myDropzone.on(&quot;dragover&quot;, function(e){
            currentDropCell = hGrid.Slick.grid.getCellFromEvent(e);
            if(currentDropCell===null){
                dropHighlight = null;
                myDropzone.options.dropDestination = null;
                hGrid.draggerGuide(dropHighlight);
            }
            else{
                currentDropCell.insertBefore = currentDropCell[&#x27;row&#x27;];

                if(hGrid.Slick.dataView.getItem(currentDropCell[&#x27;row&#x27;])[&#x27;type&#x27;]==&#x27;folder&#x27;){
                    dropHighlight = hGrid.Slick.dataView.getItem(currentDropCell[&#x27;row&#x27;]);
                    myDropzone.options.dropDestination = dropHighlight[&#x27;uid&#x27;];
                }
                else{
                    var childDropHighlight = hGrid.Slick.dataView.getItem(currentDropCell[&#x27;row&#x27;]);
                    dropHighlight = hGrid.getItemByValue(hGrid.data, childDropHighlight[&#x27;parent_uid&#x27;], &#x27;uid&#x27;);
                    myDropzone.options.dropDestination = dropHighlight[&#x27;uid&#x27;];
                }
                if(dropHighlight[&#x27;permission&#x27;]==&quot;true&quot; || typeof dropHighlight[&#x27;permission&#x27;] == &#x27;undefined&#x27;){
                    hGrid.draggerGuide(dropHighlight);
                }
            }
            if(bool){
                myDropzone.options.url = hGrid.options[&#x27;urlAdd&#x27;][myDropzone.options.dropDestination];
            }

        });

        myDropzone.on(&quot;addedfile&quot;, function(file){
            $(&#x27;.bar&#x27;).css(&#x27;width&#x27;, &quot;0%&quot;);
            var parent;
            if (myDropzone.options.dropDestination===null){
                parent = hGrid.getItemByValue(hGrid.data, myDropzone.options.dropDestination, &#x27;parent&#x27;);
            }
            else{
                parent = hGrid.getItemByValue(hGrid.data, myDropzone.options.dropDestination, &#x27;uid&#x27;);
            }
            var value = {item: file, parent: parent};
            var promise = $.when(hGrid.hGridBeforeUpload.notify(value));
            promise.always(function(event_status){
                if(event_status===false){
                    myDropzone.removeFile(file);
                    value[&#x27;success&#x27;] = false;
                    hGrid.updateNav();
                    hGrid.hGridAfterUpload.notify(value);
                }
            });
        });

        myDropzone.on(&quot;dragleave&quot;, function(e){
            hGrid.removeDraggerGuide();
        });
// Pass the destination folder to the server
        myDropzone.on(&quot;sending&quot;, function(file, xhr, formData){
            hGrid.updateNav();
            $(&#x27;#totalProgress&#x27;).show();
            $(&#x27;#totalProgressActive&#x27;).addClass(&#x27;progress progress-striped active&#x27;);
            formData.append(&quot;destination&quot;, myDropzone.options.dropDestination);
        });

        myDropzone.on(&quot;uploadprogress&quot;, function(file, progress, bytesSent){
            var ins = &quot;#&quot; + file.name.replace(/[\s\.#\&#x27;\&quot;]/g, &#x27;&#x27;);
            $(ins).css(&#x27;width&#x27;, progress + &quot;%&quot;);
        });

        myDropzone.on(&quot;totaluploadprogress&quot;, function(progress, totalBytes, totalBytesSent){
            $(&#x27;#totalProgress&#x27;).css(&#x27;width&#x27;, progress + &quot;%&quot;);
            if (progress==100){
                setTimeout(function(){

                },(1*1000));
            }
        })
// Hook the drop success to the grid view update
        myDropzone.on(&quot;success&quot;, function(file) {
            var value;
            var promise = $.when(hGrid.hGridOnUpload.notify(file));
            promise.always(function(event_status){
                $(&#x27;#totalProgressActive&#x27;).removeClass(&#x27;progress progress-striped active&#x27;);
                $(&#x27;#totalProgress&#x27;).hide();
                $(&#x27;#totalProgress&#x27;).css(&#x27;width&#x27;, &quot;0%&quot;);
                if (event_status || typeof(event_status)==&#x27;undefined&#x27;){
                    value = {item: JSON.parse(file.xhr.response)[0], success: true};
                    value[&#x27;item&#x27;][&#x27;name&#x27;] = file.name;
                    hGrid.updateNav();
                    hGrid.hGridAfterUpload.notify(value);
                }
                else{
                    value = {item: file, success: false};
                    hGrid.updateNav();
                    hGrid.hGridAfterUpload.notify(value);
                }
            });
        });
    },

    /**
     * Allows the user to add a new column to the grid
     * @method addColumn
     *
     * @param {Object} column New column to be added
     *  @param item.id ID of column
     *  @param item.name Name of column
     *  @param item.field Field of items to be put in the columns
     * @return {Boolean} True if setting columns works
     */
    addColumn: function(column) {
        var _this = this;
        var old_columns = _this.Slick.grid.getColumns();
        old_columns.push(column);
        _this.Slick.grid.setColumns(old_columns);
        return true;
    },

    /**
     * Allows the user to add a new item to the grid
     * @method addItem
     *
     * @param {Object} item New item to be added
     *  @param item.parent_uid Parent unique ID
     *  @param item.uid Unique ID
     *  @param item.name Name
     *  @param {String} item.type Folder or file
     * @return {Boolean}
     */
    addItem: function(item) {
        var _this = this;
//        if (!item[&#x27;parent_uid&#x27;] || !item[&#x27;uid&#x27;] || !item[&#x27;name&#x27;] || !item[&#x27;type&#x27;] || _this.getItemByValue(_this.data, item[&#x27;uid&#x27;], &#x27;uid&#x27;)){
//            alert(&quot;This is an invalid item.&quot;)
//            return;
//        }
        var parent= _this.getItemByValue(_this.data, item[&#x27;parent_uid&#x27;], &#x27;uid&#x27;);
        var value = {&#x27;item&#x27;: item, &#x27;parent&#x27;:parent};
        var valueAfter = {&#x27;item&#x27;: item, &#x27;parent&#x27;:parent};
        var promise = $.when(_this.hGridBeforeAdd.notify(value));
        promise.always(function(event_status){
            if(event_status || typeof(event_status)===&#x27;undefined&#x27;){
                if(item[&#x27;parent_uid&#x27;]!=&quot;null&quot; &amp;&amp; !item[&#x27;uploadBar&#x27;]){
                    var parent_path = parent[&#x27;path&#x27;];
                    item[&#x27;path&#x27;]=[];
                    item[&#x27;path&#x27;]=item[&#x27;path&#x27;].concat(parent_path, item[&#x27;uid&#x27;]);
                    item[&#x27;sortpath&#x27;]=item[&#x27;path&#x27;].join(&#x27;/&#x27;);
                    if(!item[&#x27;type&#x27;]) item[&#x27;type&#x27;]=&#x27;file&#x27;;
                }
                var sortCol = _this.Slick.grid.getSortColumns()[0];
                var spliceId = null;
                if(typeof(sortCol)!==&#x27;undefined&#x27;){
                    var sortId = sortCol[&#x27;columnId&#x27;];
                    var asc = sortCol[&#x27;sortAsc&#x27;];
                    var searchData = _this.getItemsByValue(_this.data, parent[&#x27;uid&#x27;], &quot;parent_uid&quot;);

                    if(searchData.length != 0){
                        var comp = null;
                        var compValue = null;
                        var itemValue = typeof(item[sortId]) == &#x27;string&#x27; ? item[sortId].toLowerCase() : item[sortId];
                        itemValue = sortId == &#x27;size&#x27; ? parseInt(itemValue) : itemValue;
                        for(var i=0; i&lt;searchData.length; i++){
                            comp = searchData[i];
                            compValue = typeof(comp[sortId]) == &#x27;string&#x27; ? comp[sortId].toLowerCase() : comp[sortId];
                            compValue = sortId == &#x27;size&#x27; ? parseInt(compValue) : compValue;
                            spliceId = comp[&#x27;id&#x27;]+1;
                            if(asc){
                                if(compValue &gt; itemValue){
                                    spliceId = comp[&#x27;id&#x27;];
                                    break;
                                }
                            }
                            else{
                                if(compValue &lt; itemValue){
                                    spliceId = comp[&#x27;id&#x27;];
                                    break;
                                }
                            }
                        }
                    }
                    else{
                        spliceId = parent[&#x27;id&#x27;]+1;
                    }
                }
                else{
                    spliceId = parent[&#x27;id&#x27;]+1;
                }
                _this.data.splice(spliceId, 0,item);
                _this.prepJava(_this.data);
                _this.Slick.dataView.setItems(_this.data);
                _this.Slick.grid.setSelectedRows([]);
                _this.currentlyRendered=[];
                valueAfter[&#x27;success&#x27;] = true;
                _this.hGridAfterAdd.notify(value);
                return true;
            }
            else{
                valueAfter[&#x27;success&#x27;] = false;
                _this.updateNav();
                _this.hGridAfterAdd.notify(value);
                return false;
            }
        });
    },

    /**
     * Allows the user to add a new item to the grid
     * @method uploadItem
     *
     * @param {Object} item New item to be added
     *  @param item.parent_uid Parent unique ID
     *  @param item.uid Unique ID
     *  @param item.name Name
     *  @param {String} item.type Folder or file
     * @return {Boolean}
     */
    uploadItem: function(item) {
        var _this = this;
//        if (!item[&#x27;parent_uid&#x27;] || !item[&#x27;uid&#x27;] || !item[&#x27;name&#x27;] || !item[&#x27;type&#x27;] || _this.getItemByValue(_this.data, item[&#x27;uid&#x27;], &#x27;uid&#x27;)){
//            alert(&quot;This is an invalid item.&quot;);
//            return;
//        }
        var parent= _this.getItemByValue(_this.data, item[&#x27;parent_uid&#x27;], &#x27;uid&#x27;);
        if(item[&#x27;parent_uid&#x27;]!=&quot;null&quot;){
            var parent_path = parent[&#x27;path&#x27;].slice();
            parent_path.push(item[&#x27;uid&#x27;]);
            item[&#x27;path&#x27;] = parent_path;
//                item[&#x27;path&#x27;].concat(parent_path, item[&#x27;uid&#x27;]);
            item[&#x27;sortpath&#x27;]=item[&#x27;path&#x27;].join(&#x27;/&#x27;);
        }
        _this.data.splice(parent[&#x27;id&#x27;]+1, 0,item);
        _this.prepJava(_this.data);
        _this.Slick.dataView.setItems(_this.data);
        _this.Slick.grid.invalidate();
        _this.Slick.grid.setSelectedRows([]);
        _this.currentlyRendered=[];
        _this.Slick.grid.render();
        return true;
    },

    hasChildren: function(itemUid) {
        var _this = this;
        if(_this.getItemByValue(_this.data, itemUid, &quot;parent_uid&quot;)!=false)
            return true;
        return false;
    },

    /**
     * Allows the user to move items and all of their children to another place on the grid
     * @method moveItems
     *
     * @param {Array} src_uid Unique IDs of each item that should move
     * @param {int} dest Unique ID of the destination parent
     *
     * @return {Boolean}  True if success, false if failure
     */
    moveItems: function(src_uid, dest) {
        var _this = this;
        var src_id = [];
        var destination = _this.getItemByValue(_this.data, dest, &#x27;uid&#x27;);
        var dest_path = destination[&#x27;path&#x27;];
        var url = _this.options.url;

        var value = {};
        value[&#x27;rows&#x27;]=[];
        for(var i=0; i&lt;src_uid.length; i++){
            if ($.inArray(src_uid[i], dest_path)!=-1){
                return false;
            }
            value[&#x27;rows&#x27;].push(src_uid[i]);
        }

        value[&#x27;insertBefore&#x27;]=destination[&#x27;id&#x27;]+1;
        var promise = $.when(_this.hGridBeforeMove.notify(value));
        promise.always(function(event_status){
            if(event_status || typeof(event_status)===&#x27;undefined&#x27;){
                if(_this.itemMover(value, url, src_id, dest_path)){
                    value[&#x27;success&#x27;]=true;
                    _this.updateNav();
                    _this.hGridAfterMove.notify(value);
                    return true;
                }
                else {
                    value[&#x27;success&#x27;]=&quot;There was an error with the grid&quot;;
                    _this.updateNav();
                    _this.hGridAfterMove.notify(value);
                    return false;
                }
            }
            else{
                value[&#x27;success&#x27;]=false;
                _this.updateNav();
                _this.hGridAfterMove.notify(value);
                return false;
            }
        });
    },

    /**
     * Allows the user to delete items and all of their children
     * @method deleteItems
     *
     * @param {Array} rowsToDelete Array of unique IDs of rows to delete
     * @return {Boolean}
     */
    deleteItems: function(rowsToDelete) {
        var _this = this;
        var value = {&#x27;items&#x27;: []};
        var valueAfter = {&#x27;items&#x27;:[]};
        for (var j=0; j&lt;rowsToDelete.length; j++){
            value[&#x27;items&#x27;].push(_this.getItemByValue(_this.data, rowsToDelete[j], &#x27;uid&#x27;));
            valueAfter[&#x27;items&#x27;].push(_this.getItemByValue(_this.data, rowsToDelete[j], &#x27;uid&#x27;));
        }
        var promise = $.when(_this.hGridBeforeDelete.notify(value));
        promise.always(function(event_status) {
            if(event_status || typeof(event_status)===&#x27;undefined&#x27;){
                for(var i=0; i&lt;rowsToDelete.length; i++){
                    var rows=[];
                    var check = _this.getItemByValue(_this.data, rowsToDelete[i], &#x27;uid&#x27;)[&#x27;id&#x27;];
                    var j = check;
                    do{
                        rows.push(j);
                        j+=1;
                    }while(_this.data[j] &amp;&amp; _this.data[j][&#x27;indent&#x27;]&gt;_this.data[check][&#x27;indent&#x27;]);

                    _this.data.splice(rows[0], rows.length);
                    _this.Slick.dataView.setItems(_this.data);
                }
                _this.prepJava(_this.data);
                _this.Slick.dataView.setItems(_this.data);
                _this.Slick.grid.invalidate();
                _this.Slick.grid.setSelectedRows([]);
                _this.currentlyRendered=[];
                _this.Slick.grid.render();
                valueAfter[&#x27;success&#x27;]=true;
                _this.updateNav();
                _this.hGridAfterDelete.notify(valueAfter);
                return true;
            }
            else{
                valueAfter[&#x27;success&#x27;]=false;
                _this.updateNav();
                _this.hGridAfterDelete.notify(valueAfter);
                return false;
            }
        });
    },

    /**
     * Allows the user to edit the name of the item passed
     * @method editItem
     *
     * @param src_uid Unique ID of the item to change
     * @param {String} name New name for the item being changed
     *
     * @return {Boolean}
     */
    editItem: function(src_uid, name) {
        var _this = this;
        var src = _this.getItemByValue(_this.data, src_uid, &#x27;uid&#x27;);
        var value = {&#x27;item&#x27;: src, &#x27;name&#x27;: name};
        var valueAfter = {&#x27;item&#x27;: src, &#x27;name&#x27;: name};
        var promise = $.when(_this.hGridBeforeEdit.notify(value));
        promise.always(function(event_status){
            if(event_status || typeof(event_status)===&#x27;undefined&#x27;){
                src[&#x27;name&#x27;]=name;
                _this.Slick.dataView.updateItem(src[&#x27;id&#x27;], src);
                valueAfter[&#x27;success&#x27;]=true;
                _this.hGridAfterEdit.notify(valueAfter);
                return true;
            }
            else{
                valueAfter[&#x27;success&#x27;]=false;
                _this.hGridAfterEdit.notify(valueAfter);
                return false;
            }
        });
    },

    /**
     * This function searches through the data and returns the first object with the correct value
     * @method getItemByValue
     *
     * @param {Array} data Dataset to loop through
     * @param {Object} searchVal Value to search for
     * @param {String} searchProp Property of target value
     *
     * @return {Object} Item with searchValue or false if not in dataset
    */
    getItemByValue: function(data, searchVal, searchProp) {
        var ans;
        for(var i =0; i&lt;data.length; i++){
            if(data[i][searchProp]==searchVal){
                ans=data[i];
                return ans;
            }
        }
        return false;
    },

    /**
     * This function searches through the data and returns a list of objects with the correct value
     * @method getItemsByValue
     *
     * @param {Array} data Dataset to loop through
     * @param {Object} searchVal Value to search for
     * @param {String} searchProp Property of target value
     *
     * @return {Object} Array of items with searchValue
    */
    getItemsByValue: function(data, searchVal, searchProp) {
        var propArray = [];
        for(var i =0; i&lt;data.length; i++){
            if(data[i][searchProp]==searchVal){
                propArray.push(data[i]);
            }
        }
        return propArray;
    },

    prep: function(hGridInfo){
        var indent = 0;
        var checker = {};
        var i = 0;
        var data_counter=0;
        var output = [];
        var _this = this;
        var info = hGridInfo.slice();
        while (info.length&gt;=1){

            var d = info[i];
            if (info[i][&#x27;parent_uid&#x27;]==&quot;null&quot;){
                d[&#x27;parent&#x27;]=null;
                d[&#x27;indent&#x27;]=0;
                d[&#x27;id&#x27;]=data_counter;
                checker[d[&#x27;uid&#x27;]]=[d[&#x27;indent&#x27;], data_counter];
                output[data_counter]=d;
                data_counter++;
                info.splice(i, 1);
            }
            else if(info[i][&#x27;parent_uid&#x27;] in checker){
                d[&#x27;parent&#x27;]=checker[d[&#x27;parent_uid&#x27;]][1];
                d[&#x27;indent&#x27;]=checker[d[&#x27;parent_uid&#x27;]][0]+1;
                d[&#x27;id&#x27;]=data_counter;
                checker[d[&#x27;uid&#x27;]]=[d[&#x27;indent&#x27;], data_counter];
                output[data_counter]=d;
                data_counter++;
                info.splice(i, 1);
            }
            else{
                i++;
            }
            if(i&gt;=info.length){
                i=0;
            }
            if(d[&#x27;name&#x27;]==&quot;null&quot;){
                d[&#x27;name&#x27;]+=i;
            }
        }

        for(var l=0; l&lt;output.length; l++){
            var path = [];
            path.push(output[l][&#x27;uid&#x27;]);
            if(output[l][&#x27;parent_uid&#x27;]!=&quot;null&quot;){
                for(var m=0; m&lt;l; m++){
                    if(output[m][&#x27;uid&#x27;]==output[l][&#x27;parent_uid&#x27;]){
//                        var x = m;
                        while(output[m][&#x27;parent_uid&#x27;]!=&quot;null&quot;){
                            path.push(output[m][&#x27;uid&#x27;]);
                            m = output[m][&#x27;parent&#x27;];
                        }
                        path.push(output[m][&#x27;uid&#x27;]);
                        break;
                    }
                }
            }
            path.reverse();
            output[l][&#x27;path&#x27;]=path;
            output[l][&#x27;sortpath&#x27;]=path.join(&#x27;/&#x27;);
        }
        var sortingCol=&#x27;sortpath&#x27;;
        output.sort(function(a, b){
            var x = a[sortingCol].toLowerCase(), y = b[sortingCol].toLowerCase();

            if(x == y){
                return 0;
            }
            if(_this.options.sortAsc){
                return x &gt; y ? 1 : -1;
            }
            else{
                return x &lt; y ? 1 : -1;
            }
        });
        return this.prepJava(output);
    },

    prepJava: function(sortedData, options) {
        var _this = this;
        var settings = {
            sorting: false,
        };

        settings = $.extend(settings, options);


        var output = [];
        var checker = {};
        var indent = 0;
        for (var i = 0; i &lt; sortedData.length; i++) {
            var parent;
            var d = {};
            var path = [];

            //Assign parent paths, find ID of parent and assign its ID to &quot;parent&quot; attribute
            d[&#x27;parent_uid&#x27;]=sortedData[i][&#x27;parent_uid&#x27;];
            path.push(sortedData[i][&#x27;uid&#x27;]);
            //Check if item has a parent
            if (sortedData[i][&#x27;parent_uid&#x27;]!=&quot;null&quot;){
                for(var j=0; j&lt;sortedData.length; j++){
                    if (sortedData[j][&#x27;uid&#x27;]==d[&#x27;parent_uid&#x27;] &amp;&amp; !d[&quot;parent&quot;]){
                        d[&quot;parent&quot;]= j;
                        break;
                    }
                }
                //If parent hasn&#x27;t been encountered, increment the indent
                if (!(sortedData[i][&#x27;parent_uid&#x27;] in checker)){
                    indent++;
                }
                //If it has been encountered, make indent the same as others with same parent
                else {
                    indent = checker[sortedData[i][&#x27;parent_uid&#x27;]];
                }
                //Make sure parent_uid is in checker
                checker[sortedData[i][&#x27;parent_uid&#x27;]]=indent;
            }
            //If no parent, set parent to null and indent to 0
            else {
                indent=0;
                d[&quot;parent&quot;]=null;
            }
            if (sortedData[i]._collapsed){
                d._collapsed=sortedData[i]._collapsed;
            }
            //Set other values
            d[&quot;id&quot;] = i;
            if (!settings[&#x27;sorting&#x27;]){
                d[&quot;indent&quot;] = indent;
                d[&quot;absoluteIndent&quot;] = indent;
            }
            d = $.extend(true, sortedData[i], d);
            output[i]=d;
        }
        return output;
    },

    itemMover: function (args, url, src, dest){
        this.removeDraggerGuide();
//        $.post(url, {src: JSON.stringify(src), dest: JSON.stringify(dest)}, function(response){
//            //Make sure move succeeds
//            if (response==&quot;fail&quot;){
//                alert(&quot;Move failed!&quot;);
//                return false;
//            }
//            else{

        for(var y=0; y&lt;args.rows.length; y++){
            var rows=[];
            //Make sure all children move as well
            var item = this.getItemByValue(this.data, args.rows[y], &#x27;uid&#x27;);
            var j = item[&#x27;id&#x27;];
            var stopRow;
            do{
                rows.push(j);
                j+=1;
                stopRow = j;
            }while(this.data[j] &amp;&amp; this.data[j][&#x27;indent&#x27;]&gt;item[&#x27;indent&#x27;]);

            //Update data
            var extractedRows = [], left, right;

            var insertBefore = this.Slick.grid.getDataItem(args.insertBefore)[&#x27;id&#x27;];


            left = this.data.slice(0, insertBefore);
            right = this.data.slice(insertBefore, this.data.length);

            rows.sort(function(a,b) { return a-b; });

            for (var i = 0; i &lt; rows.length; i++) {
                extractedRows.push(this.data[rows[i]]);
            }

            rows.reverse();

            for (var i = 0; i &lt; rows.length; i++) {
                var row = rows[i];
                if (row &lt; insertBefore) {
                    left.splice(row, 1);
                } else {
                    right.splice(row - insertBefore, 1);
                }
            }

//                    Change parent uid and uid

            var checker = {};
            var old_path = extractedRows[0][&#x27;path&#x27;];

            if (dest==null){
                extractedRows[0][&#x27;path&#x27;] = [extractedRows[0][&#x27;uid&#x27;]];
                extractedRows[0][&#x27;parent_uid&#x27;]=&quot;null&quot;;
                extractedRows[0][&#x27;sortpath&#x27;]=extractedRows[0][&#x27;path&#x27;].join(&#x27;/&#x27;);
            }
            else{
                extractedRows[0][&#x27;parent_uid&#x27;]=dest[dest.length-1];
                extractedRows[0][&#x27;path&#x27;] = dest.slice();
                extractedRows[0][&#x27;path&#x27;].push(extractedRows[0][&#x27;uid&#x27;]);
                extractedRows[0][&#x27;sortpath&#x27;]=extractedRows[0][&#x27;path&#x27;].join(&#x27;/&#x27;);
            }


            var new_path = extractedRows[0][&#x27;uid&#x27;];
            checker[old_path]=new_path;

            if (extractedRows.length &gt; 1){
                for(var m=1; m&lt;extractedRows.length; m++){
                    var par = this.getItemByValue(extractedRows, extractedRows[m][&#x27;parent_uid&#x27;], &#x27;uid&#x27;)[&#x27;path&#x27;];
                    extractedRows[m][&#x27;path&#x27;]= par.slice();
                    extractedRows[m][&#x27;path&#x27;].push(extractedRows[m][&#x27;uid&#x27;]);
                    extractedRows[m][&#x27;sortpath&#x27;]=extractedRows[m][&#x27;path&#x27;].join(&#x27;/&#x27;);
                }
            }

            this.data = left.concat(extractedRows.concat(right));

            var selectedRows = [];
            for (var i = 0; i &lt; rows.length; i++){
                selectedRows.push(left.length + i);
            }

            var new_data = this.prepJava(this.data);
            this.data = new_data;
        }
        this.Slick.dataView.setItems(this.data);
        this.Slick.grid.invalidate();
        this.Slick.grid.setSelectedRows([]);
        this.currentlyRendered=[];
        this.Slick.grid.render();
        return true;
    },

    removeDraggerGuide: function() {
        var _this = this;
        $(_this.options.container).find(&quot;.dragger-guide&quot;).removeClass(&quot;dragger-guide&quot;);
        $(_this.options.container).find(&quot;.slick-viewport&quot;).removeClass(&quot;dragger-guide1&quot;);
    },

    draggerGuide: function(inserter) {
        var _this = this;
        _this.removeDraggerGuide();
        var dragParent=false;
        // If a target row exists
        if(inserter==null){
            if(_this.options.largeGuide){
                $(_this.options.container).find(&quot;.slick-viewport&quot;).addClass(&quot;dragger-guide1&quot;);
            }
        }
        else{
            if (inserter[&#x27;uid&#x27;]!=&quot;uploads&quot;){
                if(inserter[&#x27;type&#x27;]==&#x27;folder&#x27;){
                    dragParent = _this.Slick.grid.getCellNode(_this.Slick.dataView.getRowById(inserter[&#x27;id&#x27;]), 0).parentNode;
                }
                else{
                    try{
                        dragParent = _this.Slick.grid.getCellNode(_this.Slick.dataView.getRowById(inserter[&#x27;parent&#x27;]), 0).parentNode;
                    }
                    catch(err){
                    }
                }
            }
            if(dragParent){
                $(dragParent).addClass(&quot;dragger-guide&quot;);
            }
        }
    },

    //Function called when sort is clicked
    onSort: function (e, args, grid, dataView, data){
        var _this = this;
        _this.options.sortAsc = !_this.options.sortAsc;
        var sortingCol = args.sortCol.field;
        var sorted = _this.sortHierarchy(data, sortingCol, dataView, grid);
        var new_data = _this.prepJava(sorted, {&#x27;sorting&#x27;: true});
        _this.data = new_data;
        dataView.setItems(new_data);
        _this.currentlyRendered=[];
        _this.updateNav();
    },

    compare: function(a, b) {
        var _this = this;
        if (a instanceof Array &amp;&amp; b instanceof Array) {
            for (var r, i=0, l=Math.min(a.length, b.length); i&lt;l; i++)
                if (r = _this.compare(a[i], b[i]))
                    return r;
            return a.length - b.length;
        } else // use native comparison algorithm, including ToPrimitive conversion
            return (a &gt; b) - (a &lt; b);
    },

    sortHierarchy: function (data, sortingCol, dataView, grid){
        var _this = this;
        var sorted = data.sort(function(a, b){
            var x = a[sortingCol], y = b[sortingCol];
            if(_this.options.sortAsc){
                return -(_this.compare(x,y));
            }
            else{
                return _this.compare(x,y);
            }
        });
        var hierarchical = [];
        this.buildHierarchy(sorted, hierarchical, undefined);
        return hierarchical;
    },

    buildHierarchy: function (sorted, hierarchical, parent) {
        for(var i=0; i &lt; sorted.length; i++)
        {
            var item = sorted[i];
            var parentId;
            if(parent){
                parentId = parent.id;
            }
            else{
                parentId = undefined;
            }
            if(item.parent == parentId){
                hierarchical.push(item);
                if (item[&#x27;type&#x27;] == &#x27;folder&#x27;) {
                    this.buildHierarchy(sorted, hierarchical, item);
                }
            }
        }
    },

    setupListeners: function(){
        var _this = this;
        var grid = this.Slick.grid;
        var data = this.data;
        var dataView = this.Slick.dataView;
        var src = [];
        var dest = &quot;&quot;;
        grid.setSelectionModel(new Slick.RowSelectionModel());
        var moveRowsPlugin = new Slick.RowMoveManager({
            cancelEditOnDrag: true
        });

        //Before rows are moved, make sure their dest is valid, document source and target
        _this.Slick.grid.onMouseEnter.subscribe(function(e, args){
            args[&#x27;e&#x27;] = e;
            _this.hGridOnMouseEnter.notify(args);
        });

        _this.Slick.grid.onMouseLeave.subscribe(function(e, args){
            args[&#x27;e&#x27;] = e;
            _this.hGridOnMouseLeave.notify(args);
        });

        moveRowsPlugin.onBeforeMoveRows.subscribe(function (e, args) {
            src = [];
            dest = &quot;&quot;;
            var inserter=null;
            if (grid.getDataItem(args.insertBefore-1)){
                if(args.insertBefore==args.rows[0]+1){
                    inserter = grid.getDataItem(args.insertBefore-2);
                }
                else{
                    inserter = grid.getDataItem(args.insertBefore-1);
                }
            }
            try{
                var insertBefore = grid.getDataItem(args.insertBefore)[&#x27;id&#x27;];
            }
            catch(error){
                if(error.name == TypeError){
                    return false;
                }
            }

            if(inserter!=null){
                if(inserter[&#x27;type&#x27;]==&#x27;folder&#x27;){
                    dest = inserter[&#x27;path&#x27;];
                }
                else{
                    dest = _this.getItemByValue(data, inserter[&#x27;parent_uid&#x27;], &#x27;uid&#x27;);
                    dest = dest[&#x27;path&#x27;];
                }
            }
            else{
                if (_this.options.navLevel == &quot;null&quot;) {
                    dest = null;
                } else {
                    dest = _this.getItemByValue(data, _this.options.navLevel, &#x27;sortpath&#x27;);
                    if (dest[&#x27;parent_uid&#x27;] == &quot;null&quot;) {
                        dest = null
                    } else {
                        dest = _this.getItemByValue(data, dest[&#x27;parent_uid&#x27;], &#x27;uid&#x27;)[&#x27;path&#x27;];
                    }
//                    dest = dest[&#x27;path&#x27;].slice();
                }
            }

            for (var i = 0; i &lt; args.rows.length; i++) {
                src[i]=_this.getItemByValue(_this.data, _this.Slick.dataView.getItem(args.rows[i])[&#x27;id&#x27;], &#x27;id&#x27;)[&#x27;path&#x27;];
//                src[i]=args.rows[i];
                if (dest==&quot;&quot;){
                    dest = null;
                }
                var index = true;

                if (dest!=null){
                    if (dest.indexOf(src[i][src[i].length-1]) != -1 || dest==&quot;catch&quot; || dest.indexOf(&quot;uploads&quot;) == 0){
                        index = false;
                    }
                }
                else{
                    inserter=null;
                }
                _this.draggerGuide(inserter);
                if (args.rows[i] == insertBefore - 1 || index == false || src[i] == &quot;uploads&quot; || dest == &quot;uploads&quot;) {
                    _this.removeDraggerGuide();
                    return false;
                }
            }
            return true;
        });

//        When rows are moved post to server and update data
        moveRowsPlugin.onMoveRows.subscribe(function(e, args){
            var src_id = [];
            for(var i=0; i&lt;src.length; i++){
                src_id.push(src[i][src[i].length-1]);
            }

            var value = {};
            value[&#x27;rows&#x27;]=[];
            for(var j=0; j&lt;src_id.length; j++){
                value[&#x27;rows&#x27;].push(src_id[j]);
            }
            value[&#x27;insertBefore&#x27;]=args[&#x27;insertBefore&#x27;];
            var promise = $.when(_this.hGridBeforeMove.notify(value));
            promise.always(function(event_status){
                if(event_status || typeof(event_status)===&#x27;undefined&#x27;){
                    _this.itemMover(value, &quot;/sg_move&quot;, src, dest);
                    value[&#x27;success&#x27;]=true;
                    _this.updateNav();
                    _this.hGridAfterMove.notify(value);
                }
                else {
                    _this.removeDraggerGuide();
                    alert(&quot;Move failed&quot;);
                    value[&#x27;success&#x27;]=false;
                    _this.updateNav();
                    _this.hGridAfterMove.notify(value);
                }
            });
        });

        grid.registerPlugin(moveRowsPlugin);

        //Update the item when edited
        grid.onCellChange.subscribe(function (e, args) {
            _this.options.editable=false;
            var src=args.item;
            _this.Slick.dataView.updateItem(src.id, src);
        });

        grid.onClick.subscribe(function (e, args) {
            _this.hGridOnClick.notify({e: e, args: args});
            if ($(e.target).hasClass(&quot;toggle&quot;) || $(e.target).hasClass(&quot;folder&quot;)) {
                var item = dataView.getItem(args.row);
                if (item) {
                    _this.currentlyRendered = [];
                    if (!item._collapsed) {
                        item._collapsed = true;
                    } else {
                        item._collapsed = false;
                    }
                    dataView.updateItem(item.id, item);
                }
                e.stopImmediatePropagation();
            }
            grid.getOptions().editable=false;
        });

        //If amount of rows are changed, update and render
        dataView.onRowCountChanged.subscribe(function (e, args) {
            grid.updateRowCount();
            grid.currentlyRendered = [];
            grid.render();
        });

        //When rows are edited, re-render
        dataView.onRowsChanged.subscribe(function (e, args) {
            grid.invalidateRows(args.rows);
            grid.currentlyRendered = [];
            grid.render();
        });

        //When columns are dragged around, make columns new order
        grid.onColumnsReordered.subscribe(function(e, args){
            grid.invalidate();
            _this.options.columns=args.cols;
            grid.currentlyRendered = [];
            grid.render();
        });

        //When sort is clicked, call sort function
        grid.onSort.subscribe(function (e, args) {
            _this.onSort(e, args, grid, _this.Slick.dataView, _this.data);
        });


        grid.onDblClick.subscribe(function (e, args) {
            var navId = $(e.target).find(&#x27;span.nav-filter-item&#x27;).attr(&#x27;data-hgrid-nav&#x27;);
            var item = _this.getItemByValue(_this.data, navId, &quot;uid&quot;);
            if(navId &amp;&amp; _this.options.navigation){
                _this.navLevelFilter(navId);
                if(_this.dropZoneObj!=null){
                    _this.dropZoneObj.options.url = item[&#x27;uploadUrl&#x27;];
                    _this.dropZoneObj.options.dropDestination = item[&#x27;uid&#x27;];
                }
            }
            e.preventDefault();
        });

        // When a Breadcrumb is clicked, the grid filters
        $(_this.options.breadcrumbBox).on(&quot;click&quot;, &quot;.hgrid-breadcrumb&gt;a&quot;, function(e) {
            var navId = $(this).attr(&#x27;data-hgrid-nav&#x27;);
            var item = _this.getItemByValue(_this.data, navId, &quot;uid&quot;);
            if(_this.dropZoneObj!=null){
                _this.dropZoneObj.options.url = item[&#x27;uploadUrl&#x27;];
                _this.dropZoneObj.options.dropDestination = item[&#x27;uid&#x27;];
            }
            _this.navLevelFilter(navId);
            e.preventDefault();

        });
        // When an HGrid item is clicked, the grid filters
        $(_this.options.container).on(&quot;click&quot;, &quot;.nav-filter-item&quot;, function(e) {
            var navId = $(this).attr(&#x27;data-hgrid-nav&#x27;);
            _this.navLevelFilter(navId);
            e.preventDefault();
        });

    }
};


    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
